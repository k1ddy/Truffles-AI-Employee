# ROADMAP — Планы развития

**Создано: 2025-12-10**

---

## Сейчас работает

- [x] Бот отвечает на вопросы (AI + knowledge base)
- [x] Эскалация в Telegram (топик + кнопки)
- [x] Менеджер отвечает из Telegram → WhatsApp
- [x] Мьют логика (1й нет = 30мин, 2й = 24ч)
- [x] Напоминания о незакрытых заявках (cron)
- [x] Настройки через БД (не хардкод)

---

## Ближайшие задачи

| Задача | Приоритет | Статус |
|--------|-----------|--------|
| История переписки в заявке для менеджера | Medium | |
| Автоприветствие менеджера | Medium | |
| "Менеджер уже занимается" при повторном вопросе | Low | |

---

## Архитектура филиалов (ПЛАН)

**Цель:** Один бот на заказчика, много групп (по филиалам)

```
Company (заказчик)
  └── telegram_bot_token (один бот)
  └── Client (бизнес)
        └── Branch (филиал)
              └── telegram_chat_id (своя группа)
              └── managers[] (менеджеры филиала)
```

**Что нужно:**
1. Перенести `telegram_bot_token` на уровень Company
2. Привязать `telegram_chat_id` к Branch
3. При эскалации — определять группу по филиалу пользователя
4. Пользователь привязывается к филиалу (по номеру или выбору)

---

## Команды в Telegram (ПЛАН)

Бот обрабатывает команды в группах менеджеров:

| Команда | Что делает |
|---------|------------|
| `/stats` | Статистика заявок (открытые, закрытые, среднее время) |
| `/mute +7...` | Замьютить клиента |
| `/unmute +7...` | Размьютить клиента |
| `/assign @manager` | Назначить менеджера на заявку |
| `/history +7...` | Показать историю переписки |

**Реализация:** обработка `message.text.startswith('/')` в telegram_webhook.py

---

## Автообучение (ПЛАН)

1. Менеджер отвечает на вопрос
2. LLM проверяет качество ответа
3. Если хорошо → кнопка "Добавить в базу" владельцу
4. Владелец подтверждает → добавляется в Qdrant

---

## Аналитика (ПЛАН)

Дашборд для владельца:
- Количество заявок по дням
- Среднее время ответа
- Топ вопросов без ответа
- Эффективность менеджеров

---

## Интеграции (ПЛАН)

| Интеграция | Зачем |
|------------|-------|
| Google Sheets | Бронирования, запись |
| 1C / Bitrix | Проверка оплаты, статус заказа |
| Instagram | Второй канал входящих |

---

*Обновлять по мере изменения приоритетов*
